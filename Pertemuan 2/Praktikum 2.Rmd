---
title: "Pertemuan 2"
author: "Atikah Maulina"
date: "2026-02-07"
output: html_document
---

# Data
## Membaca Data
```{r}
library(readxl)

data <- read_excel("C:\\Users\\ATIKAH MAULINA\\OneDrive\\Documents\\STK 4\\ANREG\\ANREG_UTS\\ANREG-Praktikum2.xlsx", sheet="Data Kabupaten-Kota")
head(data) #menampilkan sebagian data awal
```
## Menyesuaikan Peubah

Untuk mempermudah pemanggilan peubah pada saat eksplorasi dan analisis, jika pada file masih mengggunakan nama peubah yang panjang, maka bisa diganti dengan menggunakan fungsi `colnames()`. Kolom wilayah juga dapat dihapus dengan menggunakan syntax `namadata[,-1]` dengan -1 menunjukkan bahwa kolom pertama ingin dihapus.
```{r}
colnames(data) <- c("Kabupaten/Kota", "Y", paste0("X", 1:9))
head(data) #menampilkan sebagian data awal
```
# Eksplorasi Data
```{r}
n <- nrow(data)
```

```{r}
plot(data$X8, data$Y,
     main = "Tingkat Partisipasi Angkatan Kerja (TPAK) vs Indeks Pembangunan Manusia",
     xlab = "TPAK",
     ylab = "IPM")
```

```{r}
summary(data$Y)
```

```{r}
boxplot(data$Y)
```

```{r}
summary(data$X8)
```

```{r}
boxplot(data$X8)
```

# Pembentukan Model
## Manual
### Koefisien Regresi

$\hat{y_i} = \hat{\beta_0} + \hat{\beta_1} x_{i}, i = 1,2, ..., n$

$\hat{\beta_1} = \frac{\sum (x_iy)-\frac{\sum(x_i)\sum(y)}{n}}{\sum(x_i^2)-\frac{\sum(x_i^2)}{n}}$

$\hat{\beta_0} = \bar{y} - \hat{\beta_1} \bar{x}$

```{r}
x <- data$X8
y <- data$Y
```

```{r}
n <- nrow(data)
b1 <- (sum(x*y)-sum(x)*sum(y)/n)/(sum(x^2)-(sum(x)^2/n))
b0 <- mean(y)-b1*mean(x)

cat("Koefisien b0:", b0, "\n")  
cat("Koefisien b1:", b1, "\n")
```
### Standar Error Parameter Regresi
```{r}
n <- nrow(data)
galat <- y-(b0+b1*x)
ragam_galat <- sum(galat^2)/(n-2)

se_b0 <- sqrt(ragam_galat*(1/n+mean(x)^2/sum((x-mean(x))^2)))
se_b1 <- sqrt(ragam_galat/sum((x-mean(x))^2))

cat("Standar error b0:", se_b0, "\n") 
cat("Standar error b1:", se_b1, "\n")
```

### Signifikansi Parameter (nilai-t)

Nilai ini menunjukkan tingkat signifikansi secara parsial dari setiap koefisien peubah berdasarkan nilai t dan probabilitas nilai p
```{r}
n <- nrow(data)
t_b0 <- b0/se_b0
t_b1 <- b1/se_b1
p_b0 <- 2*pt(-abs(t_b0 ),df<-n-2)
p_b1 <- 2*pt(-abs(t_b1 ),df<-n-2)

cat("Nilai t pada b0 adalah", t_b0, "dengan nilai p sebesar", p_b0, "\n") 
cat("Nilai t pada b1 adalah", t_b1, "dengan nilai p sebesar", p_b1, "\n") 
```
Nilai p kurang dari alpha 0.05 untuk b0 maupun b1 sehingga signifikan pada taraf nyata 5%.

### Koefisien Determinasi dan Penyesuaiannya
Gunakan multiple R Squared untuk koefisien determinasi pada Analisis Regresi sederhana
```{r}
n <- nrow(data)
r <- (sum(x*y)-sum(x)*sum(y)/n)/
sqrt((sum(x^2)-(sum(x)^2/n))*(sum(y^2)-(sum(y)^2/n)))
Koef_det <- r^2
Koef_det
```
Gunakan adjusted R Squared untuk koefisien determinasi pada Analisis Regresi Berganda
```{r}
n <- nrow(data)
Adj_R2 <- 1-((1-Koef_det)*(n-1)/(n-1-1))
Adj_R2
```
### Signifikansi Simultan (F)

Nilai ini menunjukkan signifikansi dan kebaikan model secara simultan (bersamaan seluruh peubah) yang menjelaskan model secara keseluruhan memiliki hubungan berarti antara X dan Y.
```{r}
galat<-y-(b0+b1*x)

JKG <- sum((y - (b0+b1*x))^2)
JKReg <- sum(((b0+b1*x)- mean(y))^2)
JKT <- sum((y - mean(y))^2)
JKT <- JKReg+JKG

dbReg <- 1
dbg <- n-2
dbt <- n-1

(Fhit <- (JKReg/dbReg)/(JKG/dbg))
```

```{r}
(p_Fhit <- 1-pf(Fhit, dbReg, dbg, lower.tail = F))
```

## Menggunakan Fungsi `lm()`

Fumgsi `lm()`digunakan untuk memperoleh secara langsung nilai-nilai pada pemodelan regresi, seperti: nilai parameter, signifikansinya, standar eror, koefisien determinasi hingga ukuran keragamannya.
```{r}
model <- lm(Y~X8, data = data)
summary(model)
```

```{r}
anova(model)
```
# Kesimpulan

Model yang terbentuk adalah sebagai berikut:

$$\hat{Y} = 109.1188 -0.4662119 X_1$$
Dengan Y adalah Indeks Pembangunan Manusia dan X8 adalah Tingkat Partisipasi Angkatan Kerja (TPAK).

Didapatkan nilai $\hat\beta_0 = 109.1188$ artinya nilai dugaan rataan Indeks Pembangunan Manusia ketika Tingkat Partisipasi Angkatan Kerja (TPAK) bernilai 0 persen adalah 109.12, akan tetapi nilai 0 tidak ada dalam selang pengamatan tingkat partisipasi angkatan kerja (TPAK) sehingga $\hat\beta_0$ tidak dapat didefinisikan lebih lanjut.

Nilai $\hat\beta_1 = -0.4662119$ artinya setiap kenaikan nilai dugaan Tingkat Partisipasi Angkatan Kerja (TPAK) sebesar 1 persen akan menurunkan dugaan rataan Indeks Pembangunan Manusia sebesar 0.466.

Koefisien determinasi yang dihasilkan adalah 0.1887346 atau 18.87% artinya keragaman Indeks Pembangunan Manusia dapat dijelaskan oleh Tingkat Partisipasi Angkatan Kerja (TPAK) adalah sebesar 18.87346%, sedangkan 81.13% sisanya dijelaskan oleh faktor lain yang tidak dimasukkan ke dalam model.